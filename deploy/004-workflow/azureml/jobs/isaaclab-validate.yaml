# IsaacLab Validation Job Template
#
# This is a STRUCTURAL TEMPLATE used by submit-azureml-validation.sh.
# Values below are defaults and may be overridden at submission time.
#
# The script is responsible for:
# - Setting trained_model input (Azure ML model URI)
# - Overriding task/framework if not in model metadata
# - Setting evaluation parameters
#
# This file defines:
# - The job structure and schema
# - Input specifications with defaults
# - Environment variable mappings
# - Identity configuration
#
# To submit a validation job, use submit-azureml-validation.sh with appropriate flags.

$schema: https://azuremlschemas.azureedge.net/latest/commandJob.schema.json
type: command
display_name: IsaacLab Policy Validation
description: Validate any trained IsaacLab policy with automatic task/framework detection.
experiment_name: isaaclab-validation
identity:
  type: managed_identity

# All values below are placeholders and will be overridden by submit-azureml-validation.sh
# This file serves as a structural template for the job definition.
code: .
environment: azureml:isaaclab-training-env:2.2.0
compute: azureml:k8s-osmorobo-tst

# Inputs follow the same pattern as isaaclab-train.yaml
# - Model inputs use type/path/mode structure
# - Literal inputs are simple key-value pairs (no type declaration)
inputs:
  # Model input - will be overridden with actual model path
  # Using download mode instead of ro_mount to avoid workload identity issues
  trained_model:
    type: custom_model
    path: azureml:placeholder:1
    mode: download
  # Literal inputs - these are defaults, overridden by --set flags
  # Note: Empty strings are not allowed, use "auto" or "none" as sentinel values
  task: auto
  framework: auto
  eval_episodes: 100
  num_envs: 64
  success_threshold: -1.0

command: echo "Command will be set by submission script"

environment_variables:
  PYTHON: /workspace/isaaclab/isaaclab.sh -p
  ACCEPT_EULA: "Y"
  PRIVACY_CONSENT: "Y"

resources:
  instance_type: gpuspot
